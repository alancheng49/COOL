/* ========== Base ========== */
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  font-family: 'Microsoft JhengHei', '微軟正黑體', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background-color: #f0f2f5;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.container {
  background: #fff;
  width: 92%;
  max-width: 980px;
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
}

h1, h2, h3 { color: #333; margin: 0 0 12px; text-align: center; }

/* ========== Forms / Buttons ========== */
#login-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

input[type="text"],
input[type="password"]{
  width: 100%;
  padding: 12px 14px;
  border: 1px solid #cfcfcf;
  border-radius: 8px;
  font-size: 16px;
  background: #fff;
  outline: none;
}

button {
  padding: 12px 16px;
  border: 0;
  border-radius: 8px;
  background: #1976d2;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  transition: background .2s ease, opacity .2s ease;
}
button:hover { background: #125ea7; }
button:disabled { opacity:.6; cursor:not-allowed; }
button.secondary { background: #6b7280; }
button.secondary:hover { background: #555c69; }
button.danger { background: #d32f2f; }
button.danger:hover { background: #b22525; }

.error-message {
  color: #d32f2f;
  min-height: 20px;   /* 確保未出現時不跳動 */
  text-align: center;
}

/* 小工具 */
.row { display: flex; align-items: center; }
.gap8 { gap: 8px; }
.spacer { flex: 1; }
.hidden { display: none !important; }

/* 左上角版本號 */
#build-version{
  position: fixed;
  top: 8px;
  left: 10px;
  font-size: 10pt;
  color: #888;
  z-index: 9999;
  user-select: none;
  pointer-events: none;
  opacity: .95;
}

/* ========== Quiz Layout (Grid 版) ========== */
#quiz-layout{
  display: grid;
  grid-template-columns: 1fr 280px; /* 主面板 + 側欄 */
  gap: 18px;
}

/* 主面板 */
#question-panel{
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* 題幹：文字 + 圖片 70/30 排版 */
.q-row { display: flex; align-items: flex-start; gap: 16px; }
.q-text { flex: 7 1 0; min-width: 0; }
.q-media { flex: 3 1 0; max-width: 30%; }
.q-media img { width: 100%; height: auto; display: block; border-radius: 6px; }

/* 純文字題幹 */
#question-content h2 { text-align: left; }
#question-content img { max-width: 100%; height: auto; display: block; }

/* 選項 */
#options-container{
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.option{
  padding: 12px 14px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  background: #fff;
  cursor: pointer;
  transition: background .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.option:hover { background: #f7fbff; }
.option.selected{
  background: #e7f2ff;
  border-color: #1976d2;
  box-shadow: 0 0 0 2px rgba(25,118,210,.12) inset;
}

/* 主面板下方導覽列 */
.nav-row{
  display: flex;
  align-items: center;
  gap: 10px;
}

/* 側欄 */
#sidebar{
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.side-head{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  align-items: center;
}
.side-head h3{
  margin: 0;
  text-align: left;
}

/* 題號清單 */
#question-list{
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 8px;
}
#question-list .q-item{
  width: 100%;
  text-align: left;
  padding: 10px 12px;
  background: #f3f4f6;
  color: #374151;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  cursor: pointer;
  transition: background .15s ease, border-color .15s ease;
}
#question-list .q-item:hover{ background: #eef2f7; }
#question-list .q-item.current{
  background: #e7f2ff;
  border-color: #1976d2;
}
#question-list .q-item.answered{
  position: relative;
  border-color: #34a853;
  background: #e9f7ef;
}
#question-list .q-item.answered::after{
  content: "✓";
  position: absolute;
  right: 10px;
  top: 8px;
  color: #2e7d32;
  font-weight: 700;
}

/* 計時器（與 JS 對齊） */
.timer{
  justify-self: end;
  font-size: 12px;
  color: #666;
  padding: 6px 10px;
  border: 1px solid #e5e7eb;
  border-radius: 999px;
  background: #fafafa;
  display: inline-flex;  /* JS 會控制顯示/隱藏 */
  align-items: center;
  gap: 6px;
}
.timer.danger{ color: #c0392b; border-color: #f2c6c6; background: #fff6f6; }

/* 結果頁 */
#score{
  text-align: center;
  font-size: 22px;
  font-weight: 700;
  color: #2e7d32;
}
#wrong-answers-list{
  list-style: none;
  margin: 16px 0 0;
  padding: 0;
  display: grid;
  gap: 10px;
}
#wrong-answers-list li{
  background: #fff7f7;
  border-left: 5px solid #dc3545;
  padding: 12px;
  border-radius: 6px;
}

/* ========== Cloze（唯一保留版本，與 JS 對齊） ========== */
.cloze-wrap{
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.cloze-slot{
  border: 1px dashed #cbd5e1;
  border-radius: 6px;
  padding: 8px 10px;
  background: #f8fafc;
  font-size: 14px;
}
.cloze-slot b{ color: #0f172a; }
.cloze-grid{
  display: grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap: 8px;
  margin-top: 8px;
}
.cloze-btn{
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  background: #fff;
  cursor: pointer;
  transition: background .15s ease, border-color .15s ease, transform .05s ease;
}
.cloze-btn:hover{ background: #f7fbff; }
.cloze-btn.selected{
  background: #e7f2ff;
  border-color: #1976d2;
}

/* --- Cloze: 將新版 quiz-ui.js 的類名對應到現有樣式 --- */
.cloze-blank {        /* 等同 .cloze-slot */
  border: 1px dashed #cbd5e1;
  border-radius: 6px;
  padding: 8px 10px;
  background: #f8fafc;
  font-size: 14px;
}
.cloze-blank .label { font-weight: 600; color: #0f172a; margin-bottom: 6px; }

.cloze-options {      /* 等同 .cloze-grid */
  display: grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap: 8px;
  margin-top: 8px;
}

.cloze-option {       /* 等同 .cloze-btn */
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  background: #fff;
  cursor: pointer;
  transition: background .15s ease, border-color .15s ease, transform .05s ease;
}
.cloze-option:hover   { background: #f7fbff; }
.cloze-option.selected{
  background: #e7f2ff;
  border-color: #1976d2;
}

/* ========== Mobile ========== */
@media (max-width: 768px){
  .container { width: 96%; padding: 18px; }

  /* 排版改單欄，側欄到下方 */
  #quiz-layout{
    grid-template-columns: 1fr;
    gap: 14px;
  }
  #sidebar { order: 2; }

  /* 題幹直排 */
  .q-row{ flex-direction: column; }
  .q-media{ max-width: 100%; }

  /* 底部 sticky 導覽（保證行動版繳交鈕可見） */
  .nav-row{
    position: sticky;
    bottom: 0;
    background: #fff;
    padding: 10px;
    margin: 0 -10px -10px;         /* 撐滿容器 */
    border-top: 1px solid #e5e7eb;
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 8px;
  }

  /* 行動版專用繳交 */
  #submit-btn-mobile{ display: inline-flex; }
}

/* 結果頁骨架：上、下固定，中間滾動 */
#results-container{
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* 讓標題/分數固定在頂端 */
.results-head{
  position: sticky;
  top: 0;
  z-index: 10;
  background: #fff;
  padding: 16px 18px 12px;
  border-bottom: 1px solid #eee;
}

/* 錯題清單所在的可捲動區域：
   100dvh 可避免 iOS Safari 位址列高度變化問題 */
.results-body{
  overflow: auto;
  /* 扣掉頭尾的高度：自行微調 180~220px 之間最合適 */
  max-height: calc(100dvh - 200px);
  padding: 8px 0 12px;
}

/* 底部按鈕列固定在底部 */
.results-actions{
  position: sticky;
  bottom: 0;
  z-index: 9;
  background: #fff;
  padding: 12px 18px;
  border-top: 1px solid #eee;
}

/* 讓錯題項目之間有間距 */
#wrong-answers-list{
  list-style: none;
  margin: 0;
  padding: 0 18px 12px;
  display: grid;
  gap: 12px;
}

/* 你原本的錯題卡片樣式可保留；示意： */
#wrong-answers-list li{
  background: #fff3f3;
  border-left: 5px solid #dc3545;
  padding: 12px;
  border-radius: 8px;
}

/* 預設：行動版繳交隱藏，手機媒體查詢會打開 */
#submit-btn-mobile{ display: none; }

/* 登入按鈕 busy 樣式（雙保險） */
#login-btn.is-busy{ pointer-events: none; }